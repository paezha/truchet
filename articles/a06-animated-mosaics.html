<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="truchet">
<title>Animating mosaics • truchet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Animating mosaics">
<meta property="og:description" content="truchet">
<meta property="og:image" content="https://paezha.github.io/truchet/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">truchet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9007</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a01-designing-mosaics.html">Designing mosaics</a>
    <a class="dropdown-item" href="../articles/a02-tiles-mosaics-as-sf.html">Working with tiles and mosaics as `sf` objects</a>
    <a class="dropdown-item" href="../articles/a03-figurative-mosaics.html">Figurative mosaics with flexible tiles</a>
    <a class="dropdown-item" href="../articles/a04-figurative-mosaics-variable-width.html">Figurative mosaics with variable-width lines</a>
    <a class="dropdown-item" href="../articles/a05-boutique-collection.html">Boutique collection</a>
    <a class="dropdown-item" href="../articles/a06-animated-mosaics.html">Animating mosaics</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/paezha/truchet/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="a06-animated-mosaics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Animating mosaics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/paezha/truchet/blob/HEAD/vignettes/articles/a06-animated-mosaics.Rmd" class="external-link"><code>vignettes/articles/a06-animated-mosaics.Rmd</code></a></small>
      <div class="d-none name"><code>a06-animated-mosaics.Rmd</code></div>
    </div>

    
    
<p>Truchet tiles, by creating perfectly adaptable interlocking patterns, are great to animate. This tutorial shows how to create an animated mini-mosaic.</p>
<p>The packages used in this article (addition to {truchet}), are <a href="https://dplyr.tidyverse.org/index.htm" class="external-link">{dplyr}</a>, <a href="https://gganimate.com/articles/gganimate.html" class="external-link">{gganimate}</a>, <a href="https://ggplot2.tidyverse.org/" class="external-link">{ggplot2}</a>, <a href="https://purrr.tidyverse.org/" class="external-link">{purrr}</a>, and <a href="https://r-spatial.github.io/sf/" class="external-link">{sf}</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com" class="external-link">gganimate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paezha.github.io/truchet/">truchet</a></span><span class="op">)</span></code></pre></div>
<p>Create a function to rotate a tile. Lovelace et al. discuss how to do this with simple feature objects in their wonderful book <a href="https://geocompr.robinlovelace.net/geometric-operations.html#affine-transformations" class="external-link">Geocomputation with R</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rotation</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">type</span><span class="op">)</span><span class="op">{</span>
  <span class="va">tile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/st_truchet_p.html">st_truchet_p</a></span><span class="op">(</span>type <span class="op">=</span> <span class="va">type</span><span class="op">)</span>
  <span class="va">rm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, 
                 <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span>,
               nrow <span class="op">=</span> <span class="fl">2</span>, 
               ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="va">tile</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">tile</span><span class="op">)</span> <span class="op">*</span> <span class="va">rm</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span> </code></pre></div>
<p>Create a sequence of angles to rotate the tiles in the animation. The <code>steps_anim</code> controls the number of discrete angles for rotating the tile 180 degrees (<span class="math inline">\(\pi\)</span> radians). A large number of steps results in a smoother animation, but this also increases computation time:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pause</span> <span class="op">&lt;-</span> <span class="fl">60</span>
<span class="va">steps_anim</span> <span class="op">&lt;-</span> <span class="fl">180</span>

<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span><span class="op">/</span><span class="fl">2</span>, <span class="va">pi</span><span class="op">/</span><span class="va">steps_anim</span><span class="op">)</span>, <span class="co"># From zero to pi/2 in `pi/steps_anim` increments, basically a 90 degrees rotation</span>
       <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span>, <span class="va">pause</span><span class="op">)</span>, <span class="co"># Pause at pi/2 for `pause` </span>
       <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span>, <span class="va">pi</span>, <span class="va">pi</span><span class="op">/</span><span class="va">steps_anim</span><span class="op">)</span>, <span class="co"># From pi/2 to pi in `pi/steps_anim` increments, another 90 degrees rotation</span>
       <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">pi</span>, <span class="va">pause</span><span class="op">)</span>, <span class="co"># Pause at pi for `pause` </span>
       <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">pi</span>, <span class="fl">3</span> <span class="op">*</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span>, <span class="va">pi</span><span class="op">/</span><span class="va">steps_anim</span><span class="op">)</span>, <span class="co"># From pi to 3 * pi/2 in `pi/steps_anim` increments, another 90 degrees rotation</span>
       <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span>, <span class="va">pause</span><span class="op">)</span>, <span class="co"># Pause at 3 * pi/2 for `pause` </span>
       <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>, <span class="va">pi</span><span class="op">/</span><span class="va">steps_anim</span><span class="op">)</span>, <span class="co"># From 3 * pi/2 to 2 * pi in `pi/steps_anim` increments, another 90 degrees rotation</span>
       <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>, <span class="va">pause</span><span class="op">)</span><span class="op">)</span> <span class="co"># Pause at 2 * pi for `pause` </span></code></pre></div>
<p>In this example we will create a 2-by-2 mini-mosaic, so we need to select four tiles; here, we randomly sample four styles from all available tiles:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set seed</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7336</span><span class="op">)</span>

<span class="va">tile_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dl"</span>, <span class="st">"dr"</span>, <span class="st">"-"</span>, <span class="st">"|"</span>, <span class="st">"fnw"</span>, <span class="st">"fne"</span>, <span class="st">"fsw"</span>, <span class="st">"fse"</span>, <span class="st">"+"</span>, <span class="st">"+."</span>, <span class="st">"x."</span>, <span class="st">"tn"</span><span class="op">)</span>,
                    <span class="fl">4</span>, 
                    replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>We will place the tales in a 2-by-2 arrangement, at locations (1,1), (1,2), (2,2), and (2,1). This is the static mosaic, which we will later use as the background for the animated mosaic:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a data frame with the spots for the background tiles</span>
<span class="va">background</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,
                        tiles <span class="op">=</span> <span class="va">tile_type</span>,
                        scale_p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/st_truchet_ms.html">st_truchet_ms</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">background</span>,
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span><span class="op">)</span>,
          color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">+</span>
  <span class="co"># Select colors; this is a duotone mosaic</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"#0057b7"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#ffd700"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="a06-animated-mosaics_files/figure-html/static-mosaic-1.png" width="700"></p>
<p>Take the first tile and rotate it according to the sequence of angles defined above. Note that the coordinates of the tile need to be specified, so tile number one will be placed at (1,1). A counter is used to keep track of the discrete rotations; this is used in the animation:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tile 1</span>
<span class="co"># Initialize an empty data frame</span>
<span class="va">tile_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Initialize the counter</span>
<span class="va">count</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">a</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># Increase the counter by one</span>
  <span class="va">count</span> <span class="op">&lt;-</span> <span class="va">count</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="co"># Bind a rotated tile to the existing data frame</span>
  <span class="va">tile_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tile_1</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">rotation</span><span class="op">(</span>a <span class="op">=</span> <span class="va">i</span>, 
                                      <span class="co"># Coordinates of tile</span>
                                      x <span class="op">=</span> <span class="fl">1</span>, 
                                      y <span class="op">=</span> <span class="fl">1</span>, 
                                      type <span class="op">=</span> <span class="va">tile_type</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, 
                             state <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Convert the data frame to simple features and label it as tile 1</span>
<span class="va">tile_1</span> <span class="op">&lt;-</span> <span class="va">tile_1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tile <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Repeat to create the remaining three tiles:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tile 2</span>
<span class="va">tile_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">count</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">a</span><span class="op">)</span><span class="op">{</span>
  <span class="va">count</span> <span class="op">&lt;-</span> <span class="va">count</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="va">tile_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tile_2</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">rotation</span><span class="op">(</span>a <span class="op">=</span> <span class="va">i</span>, 
                                      <span class="co"># Coordinates of tile</span>
                                      x <span class="op">=</span> <span class="fl">2</span>, 
                                      y <span class="op">=</span> <span class="fl">2</span>, 
                                      type <span class="op">=</span> <span class="va">tile_type</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, 
                             state <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Convert the data frame to simple features and label it as tile 2</span>
<span class="va">tile_2</span> <span class="op">&lt;-</span> <span class="va">tile_2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tile <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Tile 3</span>
<span class="va">tile_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">count</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">a</span><span class="op">)</span><span class="op">{</span>
  <span class="va">count</span> <span class="op">&lt;-</span> <span class="va">count</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="va">tile_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tile_3</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">rotation</span><span class="op">(</span>a <span class="op">=</span> <span class="va">i</span>, 
                                      <span class="co"># Coordinates of tile</span>
                                      x <span class="op">=</span> <span class="fl">1</span>, 
                                      y <span class="op">=</span> <span class="fl">2</span>, 
                                      type <span class="op">=</span> <span class="va">tile_type</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, 
                             state <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Convert the data frame to simple features and label it as tile 3</span>
<span class="va">tile_3</span> <span class="op">&lt;-</span> <span class="va">tile_3</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tile <span class="op">=</span> <span class="st">"3"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Tile 4</span>
<span class="va">tile_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">count</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">a</span><span class="op">)</span><span class="op">{</span>
  <span class="va">count</span> <span class="op">&lt;-</span> <span class="va">count</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="va">tile_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tile_4</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">rotation</span><span class="op">(</span>a <span class="op">=</span> <span class="va">i</span>, 
                                      <span class="co"># Coordinates of tile</span>
                                      x <span class="op">=</span> <span class="fl">2</span>, 
                                      y <span class="op">=</span> <span class="fl">1</span>, 
                                      type <span class="op">=</span> <span class="va">tile_type</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, 
                             state <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Convert the data frame to simple features and label it as tile 4</span>
<span class="va">tile_4</span> <span class="op">&lt;-</span> <span class="va">tile_4</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tile <span class="op">=</span> <span class="st">"4"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Here we assemble mosaic by binding all the animated tiles:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mosaic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tile_1</span>,
                <span class="va">tile_2</span>,
                <span class="va">tile_3</span>,
                <span class="va">tile_4</span><span class="op">)</span></code></pre></div>
<p>When creating the plot, we can limit the extent of the coordinates to “crop” the mosaic to a square. Create plot and render the animation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Render the static background mosaic</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">background</span>,
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span><span class="op">)</span>,
          color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Render the animated tiles: first the tiles of color 1</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mosaic</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>,
              <span class="co"># It is important to group by `state` and `tile` otherwise the animation gets wacky</span>
              group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">state</span>, <span class="va">tile</span><span class="op">)</span><span class="op">)</span>,
          color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Render the animated tiles: then the tiles of color 2</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mosaic</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>,
              <span class="co"># It is important to group by `state` and `tile` otherwise the animation gets wacky</span>
              group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">state</span>, <span class="va">tile</span><span class="op">)</span><span class="op">)</span>,
          color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Select colors; this is a duotone mosaic</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"#0057b7"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#ffd700"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="co"># "Crop" the mosaic by limiting the extent of the coordinates</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>,
           ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>,
           expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># This is what makes things move</span>
  <span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/transition_time.html" class="external-link">transition_time</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span></code></pre></div>
<p>Finally render the animation with desired parameters:</p>
<pre><code><span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/animate.html" class="external-link">animate</a></span><span class="op">(</span><span class="va">p</span>, 
        rewind <span class="op">=</span> <span class="cn">FALSE</span>,
        end_pause <span class="op">=</span> <span class="fl">10</span>,
        fps <span class="op">=</span> <span class="fl">60</span>,
        duration <span class="op">=</span> <span class="fl">10</span>,
        res <span class="op">=</span> <span class="fl">300</span>,
        height <span class="op">=</span> <span class="fl">1.0</span>, 
        width <span class="op">=</span> <span class="fl">1.0</span>,
        units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></code></pre>
<p><img src="animated-mosaic-7336.gif"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Antonio Páez.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
